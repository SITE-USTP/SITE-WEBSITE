---
import { type CollectionEntry } from "astro:content";
import "./EventCard.css";

interface Props {
    event: CollectionEntry<"events">;
}

const { event } = Astro.props;
const { title, date, location, status, flyer, registrationLink } = event.data;

const formattedDate = date.toLocaleDateString("en-US", {
    weekday: "short",
    year: "numeric",
    month: "short",
    day: "numeric",
    hour: "2-digit",
    minute: "2-digit",
});

const statusClass = `status-${status.toLowerCase()}`;
---

<div class="event-card">
    <div class="event-card-image-container">
        {
            flyer ? (
                <img src={flyer} alt={title} class="event-card-image" />
            ) : (
                <div class="w-full h-full bg-gray-800 flex items-center justify-center">
                    <span class="text-gray-600 text-4xl">ğŸ“…</span>
                </div>
            )
        }
        <span class={`event-card-status ${statusClass}`}>{status}</span>
    </div>

    <div class="event-card-content">
        <div class="event-card-date">
            <span>ğŸ“…</span>
            <time datetime={date.toISOString()}>{formattedDate}</time>
        </div>

        <h3 class="event-card-title">{title}</h3>

        <div class="event-card-location">
            <span>ğŸ“</span>
            <span>{location}</span>
        </div>

        <div class="event-card-footer">
            {
                registrationLink && status === "Upcoming" ? (
                    <a
                        href={registrationLink}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="btn-primary text-sm inline-block w-full text-center"
                    >
                        Register Now
                    </a>
                ) : (
                    <span class="text-gray-500 text-sm">
                        {status === "Completed"
                            ? "Event Ended"
                            : "Registration Closed"}
                    </span>
                )
            }
        </div>
    </div>
</div>
